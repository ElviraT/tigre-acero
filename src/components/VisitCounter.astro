---
// Este componente muestra un contador de visitas usando GoatCounter
---

<div id="visit-counter" class="fixed bottom-4 right-4 bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm rounded-lg shadow-lg p-3 text-sm text-gray-700 dark:text-gray-200 z-50 border border-gray-200 dark:border-gray-700">
  <div class="flex items-center space-x-2">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-500" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
    </svg>
    <span id="visit-count" class="font-medium">Cargando visitas...</span>
  </div>
</div>

<script>
// Verificar si estamos en el navegador
if (typeof window !== 'undefined') {
  // Cargar el script de GoatCounter
  const script = document.createElement('script');
  script.src = '//gc.zgo.at/count.js';
  script.async = true;
  script.setAttribute('data-goatcounter', 'https://elvirat.goatcounter.com/count');
  document.head.appendChild(script);

  // Función para actualizar el contador
  function updateCounter() {
    const counterElement = document.getElementById('visit-count');
    
    // Verificar si GoatCounter está cargado
    if (window.goatcounter && window.goatcounter.visit_count) {
      // Usar el método de conteo de visitas de GoatCounter
      window.goatcounter.visit_count({
        append: '#visit-count',
        path: window.location.pathname,
        callback: function(count) {
          if (count && count > 0) {
            counterElement.textContent = `${count} visitas`;
          } else {
            counterElement.textContent = 'Visitas: -';
          }
        }
      });
    } else {
      // Si GoatCounter no está cargado, intentar de nuevo en 100ms
      setTimeout(updateCounter, 100);
    }
  }
  
  // Inicializar el contador cuando el DOM esté listo
  document.addEventListener('DOMContentLoaded', () => {
    // Iniciar el contador
    updateCounter();
    
    // Actualizar el contador periódicamente (cada minuto)
    setInterval(updateCounter, 60000);
  });
}
</script>

<style>
/* Estilos responsivos */
#visit-counter {
  transition: all 0.3s ease;
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

#visit-counter:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

@media (max-width: 640px) {
  #visit-counter {
    right: 0.75rem;
    bottom: 0.75rem;
    font-size: 0.75rem;
    padding: 0.5rem 0.75rem;
  }
}
</style>
